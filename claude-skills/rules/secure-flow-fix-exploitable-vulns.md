---
description: Fix CISA Known Exploited Vulnerabilities (KEV) if exists in your codebase. Search for vulnerabilities that are listed in the CISA Known Exploited Vulnerabilities (KEV) catalog using Trivy filesystem scanning. If any of these vulnerabilities are found, fix them by the CVE notes.
languages:
- python
- javascript
- typescript
- java
- go
- ruby
- php
- csharp
- docker
- yaml
alwaysApply: false
---

rule_id: secure-flow-fix-exploitable-vulns

## Fix Exploitable Vulnerabilities

Fix CISA Known Exploited Vulnerabilities (KEV) if exists in your codebase. Search for vulnerabilities that are listed in the CISA Known Exploited Vulnerabilities (KEV) catalog using Trivy filesystem scanning. If any of these vulnerabilities are found, fix them by the CVE notes.

### Trivy Filesystem Scan
- Use only Trivy filesystem scanning via the aquasecurity/trivy-action GitHub Action
- Do not integrate with other security tools
- Configure Trivy to scan the filesystem for vulnerabilities
- Ensure output is in JSON format and saved for the next steps

### CISA KEV Catalog Download
- Create a step that downloads the CISA KEV catalog in JSON format
- Use URL: `https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json`

### Vulnerability Matching
- Parse the Trivy JSON output to extract CVE IDs
- Match CVE IDs from Trivy output with the CISA KEV catalog
- Use CVE ID from Trivy output to match it with the CISA KEV catalog
- If CVE ID is found in the catalog, the CI/CD should fail and block the commit

### Logging and Reporting
- Add detailed logs showing the number of vulnerabilities found
- Display vulnerability details including:
  - CVE ID
  - CISA Details (Vendor, Product, Vulnerability Name, Due Date, Required Action)
  - Affected Packages (Package Name, Current Version, Fixed Version, Severity, Description)
- Show user confidence that the workflow is working

### Fix Vulnerabilities
- Use the notes section in the downloaded URL to find out specific info about the vulnerability
- Fix it accordingly

### Implementation Checklist
- [ ] Performed Trivy filesystem scan
- [ ] Downloaded CISA KEV catalog
- [ ] Matched CVE IDs from Trivy output with CISA KEV catalog
- [ ] Identified exploited vulnerabilities in codebase
- [ ] Logged vulnerability details (CVE ID, CISA details, affected packages)
- [ ] Reviewed CISA notes for vulnerability-specific information
- [ ] Fixed identified vulnerabilities
- [ ] Verified fixes by re-running Trivy scan

